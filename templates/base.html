<!doctype html>
<html lang="fr">
{% load static %}

<head>
  <meta charset="utf-8" />
  <title>{% block title %}SecureApp{% endblock %}</title>

</head>

<body>
  {% if messages %}
    <ul>
      {% for m in messages %}
        <li>{{ m }}</li>
      {% endfor %}
    </ul>
  {% endif %}
  {% block content %}{% endblock %}

<script>
function getCookie(name) {
  const value = `; ${document.cookie}`;
  const parts = value.split(`; ${name}=`);
  if (parts.length === 2) return parts.pop().split(';').shift();
}

const csrftoken = getCookie('csrftoken');

// Exemple fetch POST
async function postWithCSRF(url, data) {
  const resp = await fetch(url, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-CSRFToken': csrftoken
    },
    body: JSON.stringify(data),
    credentials: 'same-origin'
  });
  return resp.json();
}
</script>

</body>
</html>
